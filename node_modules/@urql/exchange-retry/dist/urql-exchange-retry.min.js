"use strict";var r=require("wonka"),e=require("@urql/core");function t(){return(t=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t,n=arguments[e];for(t in n)Object.prototype.hasOwnProperty.call(n,t)&&(r[t]=n[t])}return r}).apply(this,arguments)}function n(r){return r&&r.networkError}exports.retryExchange=function(o){var a=o.initialDelayMs||1e3,u=o.maxDelayMs||15e3,i=o.maxNumberAttempts||2,c=o.randomDelay||!0,y=o.retryIf||n;return function(n){var o=n.forward;return function(n){var f=r.share(n),l=(n=r.makeSubject()).source,s=n.next;return n=r.mergeMap((function(n){var o=n.key,i=n.context,y=(i.retryCount||0)+1;i=i.retryDelay||a;var l=Math.random()+1.5;return c&&i*l<u&&(i*=l),l=r.filter((function(r){return("query"===r.kind||"teardown"===r.kind)&&r.key===o}))(f),r.takeUntil(l)(r.delay(i)(r.fromValue(e.makeOperation(n.kind,n,t({},n.context,{retryDelay:i,retryCount:y})))))}))(l),r.filter((function(r){return!r.error||!y(r.error,r.operation)||(r.operation.context.retryCount||0)>=i-1||(s(r.operation),!1)}))(r.share(o(r.merge([f,n]))))}}};
//# sourceMappingURL=urql-exchange-retry.min.js.map
